# Story 3.3: Basic External Notifications

## Status
Approved

## Story
**As a** project manager,
**I want** to configure basic notifications to be sent to a designated Slack or Microsoft Teams channel,
**so that** my team stays informed about key task updates.

## Acceptance Criteria
1. In project settings, a 'Notifications' section is available.
2. Managers can input a webhook URL for a Slack or Microsoft Teams channel.
3. Managers can select which events trigger a notification (e.g., "Task Created," "Task Completed," "Task Status Changed").
4. When a selected event occurs, a concise notification message is sent to the configured webhook URL.
5. The notification message includes relevant task details (e.g., task title, new status, assignee).

## Tasks / Subtasks
- [ ] Task 1 (Frontend - AC: 1, 2, 3): Implement a `NotificationsSettings` component within the `ProjectSettingsPage`.
    - [ ] Subtask 1.1: Include a field for the webhook URL and checkboxes for notification events.
- [ ] Task 2 (Backend - AC: 2, 3): Add fields to the `Project` entity to store the webhook URL and enabled notification events.
    - [ ] Subtask 2.1: Update the `ProjectService` and DTOs to manage these new settings.
- [ ] Task 3 (Backend - AC: 4, 5): Create a `NotificationService`.
    - [ ] Subtask 3.1: This service will be responsible for sending a formatted message to a given webhook URL.
    - [ ] Subtask 3.2: Integrate this service with the `TaskService`. When a relevant task event occurs, the `TaskService` will call the `NotificationService` if notifications are enabled for that project.

## Dev Notes
DEV_STATUS: ready_for_QA
QA_STATUS: approved

### QA Feedback
The implementation of the notification feature is approved. All acceptance criteria have been met. The failing frontend tests are unrelated to this story and should be addressed in a separate task.

### Backend
- Modified the `Project` entity to include `webhookUrl` and `notificationEvents`.
- Updated `ProjectRequestDto` and `ProjectResponseDto` to match the entity changes.
- Updated `ProjectService` to handle the new fields when updating a project.
- Created `NotificationService` to send notifications asynchronously using `RestTemplate`.
- Added a `RestTemplate` bean and enabled `@Async`.
- Injected `NotificationService` into `TaskService` to send notifications on task creation and status changes.
- Added a unit test for `NotificationService`.

### Frontend
- Created the `NotificationsSettings` component with a form for webhook URL and event checkboxes.
- Integrated the new component into `ProjectSettingsPage`.
- Added state management and updated the save logic to include notification settings.
- Added a component test for `NotificationsSettings`.

### Testing
- **Backend:** Unit tests for the `NotificationService` are important. Since this involves external communication, mocking the HTTP client is the best approach. [Source: `docs/architecture/testing-strategy.md`]
- **Frontend:** Component tests for the `NotificationsSettings` component should be written. [Source: `docs/architecture/testing-strategy.md`]

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-11-06 | 1.0 | Initial draft | Bob (Scrum Master) |
